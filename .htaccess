RewriteEngine On
RewriteRule ^$ index [L]

# If the request is for the root or a directory
DirectoryIndex index
RewriteRule ^$ - [L]

# Allow access without .php extension
RewriteRule ^([a-zA-Z0-9_-]+)$ $1.php [L]

# Deny direct access to .php files
RewriteCond %{THE_REQUEST} "\s/.+\.php\s" [NC]
RewriteRule ^ - [F]

# Allow access from localhost and local IP ranges
<FilesMatch "\.php$">
    Require ip 127.0.0.1 ::1 192.168.0.0/16 10.0.0.0/8
</FilesMatch>
